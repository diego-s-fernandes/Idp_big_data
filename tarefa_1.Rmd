---
title: "tarefa 1"
author: "Diego dos Santos Fernandes"
date: "22/10/2019"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stringr)
library(stargazer)
library(kableExtra)


library(readr)
battles <- read_csv("battles.csv")

library(readr)
character_deaths <- read_csv("character-deaths.csv")

```


```{r}

#Tabela 1

tabela1 <- battles %>%
  group_by(attacker_king) %>% 
  summarise(name = n()) %>% 
  mutate(rel.freq = paste0(round(100 * name/sum(name), 0), "%"))
 

  
tabela1 %>%
  rename(`Rei Agressor` = attacker_king,
         `Qtd batalhas` = name,
         `Frequencia` = rel.freq) %>% 
  kable() %>%
  kable_styling(bootstrap_options = "striped", full_width = F)  


tabela2.0 <-  battles %>%
   group_by(attacker_king, attacker_outcome) %>% 
  summarise(name = n()) %>% 
  na.omit()
 
tabela2.1 <- tabela2.0 %>%  
  spread(key = attacker_outcome, value = name)

tabela2.1 <- tabela2.1 %>% 
  mutate(loss = replace_na(loss,0)) %>% 
  mutate(tx_sucesso =  paste0 (round( 100 * win/(win + loss),2), "%"))
  

tabela2 <- tabela2.1

tabela2 %>% 
  rename(`Rei Agressor` = attacker_king,
         `Derrotas` = loss,
         `VitÃ³rias` = win) %>% 
  kable() %>%
    kable_styling(bootstrap_options = "striped", full_width = F)  

tabela2dt <- as.data.frame(tabela2)
#a

```






```{r}









